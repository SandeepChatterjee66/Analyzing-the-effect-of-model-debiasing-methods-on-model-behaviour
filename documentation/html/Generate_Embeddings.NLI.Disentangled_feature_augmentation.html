<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Generate_Embeddings.NLI.Disentangled_feature_augmentation package &mdash; Effects of Debiasing on Model Behaviour  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=b3ba4146"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Generate_Embeddings.NLI.Feature_sieve package" href="Generate_Embeddings.NLI.Feature_sieve.html" />
    <link rel="prev" title="Generate_Embeddings.NLI package" href="Generate_Embeddings.NLI.html" />
    <link href="_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Effects of Debiasing on Model Behaviour
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Model Analysis</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="Generate_Embeddings.html">Generate_Embeddings package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="Generate_Embeddings.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="Generate_Embeddings.Entity_classification.html">Generate_Embeddings.Entity_classification package</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="Generate_Embeddings.NLI.html">Generate_Embeddings.NLI package</a></li>
<li class="toctree-l4"><a class="reference internal" href="Generate_Embeddings.Paraphrase_identification.html">Generate_Embeddings.Paraphrase_identification package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Generate_Embeddings.html#module-Generate_Embeddings">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Model_Analysis.html">Model_Analysis package</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Effects of Debiasing on Model Behaviour</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">Model Analysis</a></li>
          <li class="breadcrumb-item"><a href="Generate_Embeddings.html">Generate_Embeddings package</a></li>
          <li class="breadcrumb-item"><a href="Generate_Embeddings.NLI.html">Generate_Embeddings.NLI package</a></li>
      <li class="breadcrumb-item active">Generate_Embeddings.NLI.Disentangled_feature_augmentation package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Generate_Embeddings.NLI.Disentangled_feature_augmentation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="generate-embeddings-nli-disentangled-feature-augmentation-package">
<h1>Generate_Embeddings.NLI.Disentangled_feature_augmentation package<a class="headerlink" href="#generate-embeddings-nli-disentangled-feature-augmentation-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-Generate_Embeddings.NLI.Disentangled_feature_augmentation.data_loader">
<span id="generate-embeddings-nli-disentangled-feature-augmentation-data-loader-module"></span><h2>Generate_Embeddings.NLI.Disentangled_feature_augmentation.data_loader module<a class="headerlink" href="#module-Generate_Embeddings.NLI.Disentangled_feature_augmentation.data_loader" title="Permalink to this heading"></a></h2>
<p>This script contains classes and functions for loading and processing datasets
for question pair classification tasks.</p>
<dl class="py class">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.data_loader.hans_dataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.data_loader.</span></span><span class="sig-name descname"><span class="pre">hans_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sentence1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/data_loader.html#hans_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.data_loader.hans_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></p>
<p>Dataset class for the HANS dataset.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.data_loader.load_hans">
<span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.data_loader.</span></span><span class="sig-name descname"><span class="pre">load_hans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/data_loader.html#load_hans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.data_loader.load_hans" title="Permalink to this definition"></a></dt>
<dd><p>Loads the HANS dataset from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<em>str</em>) – Path to the HANS dataset file.</p></li>
<li><p><strong>tokenizer</strong> (<em>transformers.PreTrainedTokenizer</em>) – The tokenizer to use.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The loaded HANS dataset object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.data_loader.load_mnli">
<span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.data_loader.</span></span><span class="sig-name descname"><span class="pre">load_mnli</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/data_loader.html#load_mnli"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.data_loader.load_mnli" title="Permalink to this definition"></a></dt>
<dd><p>Loads the MNLI dataset from a file and return the dataset object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<em>str</em>) – Path to the MNLI dataset file.</p></li>
<li><p><strong>tokenizer</strong> (<em>transformers.PreTrainedTokenizer</em>) – The tokenizer to use.</p></li>
<li><p><strong>type</strong> (<em>bool</em>) – Boolean indicating the type of MNLI data(train or dev) (type = True for train).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The loaded MNLI dataset object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.data_loader.load_snli">
<span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.data_loader.</span></span><span class="sig-name descname"><span class="pre">load_snli</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/data_loader.html#load_snli"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.data_loader.load_snli" title="Permalink to this definition"></a></dt>
<dd><p>Loads the SNLI dataset from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<em>str</em>) – Path to the SNLI dataset file.</p></li>
<li><p><strong>tokenizer</strong> (<em>transformers.PreTrainedTokenizer</em>) – The tokenizer to use.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The loaded SNLI dataset object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>data</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.data_loader.mnli_dataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.data_loader.</span></span><span class="sig-name descname"><span class="pre">mnli_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sentence1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/data_loader.html#mnli_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.data_loader.mnli_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></p>
<p>Dataset class for the Multi-Genre Natural Language Inference (MNLI) dataset.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.data_loader.tokenize_sent">
<span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.data_loader.</span></span><span class="sig-name descname"><span class="pre">tokenize_sent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sentence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/data_loader.html#tokenize_sent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.data_loader.tokenize_sent" title="Permalink to this definition"></a></dt>
<dd><p>Tokenizes a given sentence using the provided tokenizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sentence</strong> (<em>str</em>) – The sentence to tokenize.</p></li>
<li><p><strong>tokenizer</strong> (<em>transformers.PreTrainedTokenizer</em>) – The tokenizer to use.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of tokenized words.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-Generate_Embeddings.NLI.Disentangled_feature_augmentation.generate_embeddings">
<span id="generate-embeddings-nli-disentangled-feature-augmentation-generate-embeddings-module"></span><h2>Generate_Embeddings.NLI.Disentangled_feature_augmentation.generate_embeddings module<a class="headerlink" href="#module-Generate_Embeddings.NLI.Disentangled_feature_augmentation.generate_embeddings" title="Permalink to this heading"></a></h2>
<p>This script is designed to generate embeddings
from the model, and save these embeddings to text files.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">generate_embeddings</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">input_model_path</span> <span class="o">&lt;</span><span class="n">path_to_pretrained_model</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">mnli_path</span> <span class="o">&lt;</span><span class="n">path_to_mnli_train_file</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">mnli_val_path</span> <span class="o">&lt;</span><span class="n">path_to_mnli_val</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">hans_test_path</span> <span class="o">&lt;</span><span class="n">hans_dataset_path</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">input_model_path</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Path</span> <span class="n">to</span> <span class="n">the</span> <span class="n">pretrained</span> <span class="n">model</span> <span class="n">directory</span><span class="o">.</span>
<span class="o">--</span><span class="n">mnli_train_path</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Path</span> <span class="n">to</span> <span class="n">the</span> <span class="n">MNLI</span> <span class="n">train</span> <span class="n">dataset</span> <span class="n">file</span><span class="o">.</span>
<span class="o">--</span><span class="n">mnli_val_path</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Path</span> <span class="n">to</span> <span class="n">the</span> <span class="n">MNLI</span> <span class="n">validation</span> <span class="n">dataset</span> <span class="n">file</span><span class="o">.</span>
<span class="o">--</span><span class="n">hans_test_path</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Path</span> <span class="n">to</span> <span class="n">the</span> <span class="n">HANS</span> <span class="n">test</span> <span class="n">file</span><span class="o">.</span>
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.generate_embeddings.MainModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.generate_embeddings.</span></span><span class="sig-name descname"><span class="pre">MainModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/generate_embeddings.html#MainModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.generate_embeddings.MainModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BertPreTrainedModel</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.generate_embeddings.MainModel.features">
<span class="sig-name descname"><span class="pre">features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token_type_ids</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/generate_embeddings.html#MainModel.features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.generate_embeddings.MainModel.features" title="Permalink to this definition"></a></dt>
<dd><p>Extracts features from input using two BERT models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_ids</strong> (<em>Tensor</em>) – The input token IDs.</p></li>
<li><p><strong>attention_mask</strong> (<em>Tensor</em>) – The attention mask.</p></li>
<li><p><strong>token_type_ids</strong> (<em>Tensor</em>) – The token type IDs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Concatenated features from both BERT models.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.generate_embeddings.MainModel.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.generate_embeddings.MainModel.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.generate_embeddings.generate_embeddings">
<span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.generate_embeddings.</span></span><span class="sig-name descname"><span class="pre">generate_embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/generate_embeddings.html#generate_embeddings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.generate_embeddings.generate_embeddings" title="Permalink to this definition"></a></dt>
<dd><p>Generates and saves embeddings from the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.generate_embeddings.MainModel" title="Generate_Embeddings.NLI.Disentangled_feature_augmentation.generate_embeddings.MainModel"><em>MainModel</em></a>) – The model to generate embeddings from.</p></li>
<li><p><strong>dataloader</strong> (<em>DataLoader</em>) – The DataLoader object containing the dataset.</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device to run the model on (‘cuda’ or ‘cpu’).</p></li>
<li><p><strong>output_file_path</strong> (<em>str</em>) – The path to save the output embeddings text file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The list of embeddings generated.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[List[float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.generate_embeddings.main">
<span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.generate_embeddings.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/generate_embeddings.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.generate_embeddings.main" title="Permalink to this definition"></a></dt>
<dd><p>Main function to generate embeddings from the model and save them to files.</p>
<p>This function loads the required datasets, initializes the model and tokenizer,
generates embeddings for each dataset, and saves them to corresponding output files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.generate_embeddings.save_embeddings_to_text_file">
<span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.generate_embeddings.</span></span><span class="sig-name descname"><span class="pre">save_embeddings_to_text_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embeddings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/generate_embeddings.html#save_embeddings_to_text_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.generate_embeddings.save_embeddings_to_text_file" title="Permalink to this definition"></a></dt>
<dd><p>Saves embeddings to a text file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>embeddings</strong> (<em>List</em><em>[</em><em>Tensor</em><em>]</em>) – List of embedding tensors.</p></li>
<li><p><strong>output_file_path</strong> (<em>str</em>) – The path to the output text file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-Generate_Embeddings.NLI.Disentangled_feature_augmentation.test">
<span id="generate-embeddings-nli-disentangled-feature-augmentation-test-module"></span><h2>Generate_Embeddings.NLI.Disentangled_feature_augmentation.test module<a class="headerlink" href="#module-Generate_Embeddings.NLI.Disentangled_feature_augmentation.test" title="Permalink to this heading"></a></h2>
<p>This script test the model trained for Natural Language Inference(NLI) task. It saves the prediction file and the softmax score file</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">test</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">input_model_path</span> <span class="o">&lt;</span><span class="n">path_to_pretrained_model</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">mnli_path</span> <span class="o">&lt;</span><span class="n">path_to_mnli_train_file</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">mnli_val_path</span> <span class="o">&lt;</span><span class="n">path_to_mnli_val</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">hans_test_path</span> <span class="o">&lt;</span><span class="n">hans_dataset_path</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">input_model_path</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Path</span> <span class="n">to</span> <span class="n">the</span> <span class="n">pretrained</span> <span class="n">model</span> <span class="n">directory</span><span class="o">.</span>
<span class="o">--</span><span class="n">mnli_train_path</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Path</span> <span class="n">to</span> <span class="n">the</span> <span class="n">MNLI</span> <span class="n">train</span> <span class="n">dataset</span> <span class="n">file</span><span class="o">.</span>
<span class="o">--</span><span class="n">mnli_val_path</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Path</span> <span class="n">to</span> <span class="n">the</span> <span class="n">MNLI</span> <span class="n">validation</span> <span class="n">dataset</span> <span class="n">file</span><span class="o">.</span>
<span class="o">--</span><span class="n">hans_test_path</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Path</span> <span class="n">to</span> <span class="n">the</span> <span class="n">HANS</span> <span class="n">test</span> <span class="n">file</span><span class="o">.</span>
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.GeneralizedCELoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.</span></span><span class="sig-name descname"><span class="pre">GeneralizedCELoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/test.html#GeneralizedCELoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.GeneralizedCELoss" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Generalized Cross Entropy Loss.</p>
<p>This loss function computes the generalized cross entropy loss given the logits
and the target labels. It is defined as follows:</p>
<p>Loss = -∑(pk^q * log(pk)) / q</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>q</strong> (<em>float</em>) – The power parameter for the Generalized Cross Entropy Loss.
Default is 0.7.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The computed loss value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tensor</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NameError</strong> – If the computed probabilities or targets contain NaN values.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.GeneralizedCELoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/test.html#GeneralizedCELoss.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.GeneralizedCELoss.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the Generalized Cross Entropy Loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logits</strong> (<em>tensor</em>) – The logits tensor from the model.</p></li>
<li><p><strong>targets</strong> (<em>tensor</em>) – The target labels tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The computed loss tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tensor</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NameError</strong> – If the computed probabilities or targets contain NaN values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.GeneralizedCELoss.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.GeneralizedCELoss.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.</span></span><span class="sig-name descname"><span class="pre">MainModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/test.html#MainModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BertPreTrainedModel</span></code></p>
<p>Main Model incorporating two BERT models.</p>
<p>This model combines two BERT models, one for conflict detection and the other for alignment detection.
It generates features using each BERT model and then passes them through linear layers for classification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>BertConfig</em>) – The configuration object.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel.num_labels">
<span class="sig-name descname"><span class="pre">num_labels</span></span><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel.num_labels" title="Permalink to this definition"></a></dt>
<dd><p>The number of labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel.model_l">
<span class="sig-name descname"><span class="pre">model_l</span></span><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel.model_l" title="Permalink to this definition"></a></dt>
<dd><p>BERT model for conflict detection.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>BertModel</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel.model_b">
<span class="sig-name descname"><span class="pre">model_b</span></span><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel.model_b" title="Permalink to this definition"></a></dt>
<dd><p>BERT model for alignment detection.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>BertModel</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel.fc_l_1">
<span class="sig-name descname"><span class="pre">fc_l_1</span></span><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel.fc_l_1" title="Permalink to this definition"></a></dt>
<dd><p>Linear layer for conflict detection.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Linear</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel.fc_l_2">
<span class="sig-name descname"><span class="pre">fc_l_2</span></span><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel.fc_l_2" title="Permalink to this definition"></a></dt>
<dd><p>Linear layer for conflict detection.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Linear</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel.fc_b_1">
<span class="sig-name descname"><span class="pre">fc_b_1</span></span><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel.fc_b_1" title="Permalink to this definition"></a></dt>
<dd><p>Linear layer for alignment detection.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Linear</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel.fc_b_2">
<span class="sig-name descname"><span class="pre">fc_b_2</span></span><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel.fc_b_2" title="Permalink to this definition"></a></dt>
<dd><p>Linear layer for alignment detection.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Linear</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel.features">
<span class="sig-name descname"><span class="pre">features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/test.html#MainModel.features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel.features" title="Permalink to this definition"></a></dt>
<dd><p>Generate features using BERT models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_ids</strong> (<em>torch.Tensor</em>) – The input token IDs tensor.</p></li>
<li><p><strong>attention_mask</strong> (<em>torch.Tensor</em>) – The attention mask tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing the features from the conflict BERT model and the alignment BERT model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel.linear">
<span class="sig-name descname"><span class="pre">linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_conflict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_align</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/test.html#MainModel.linear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel.linear" title="Permalink to this definition"></a></dt>
<dd><p>Pass features through linear layers for classification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_conflict</strong> (<em>torch.Tensor</em>) – Features from the conflict BERT model.</p></li>
<li><p><strong>z_align</strong> (<em>torch.Tensor</em>) – Features from the alignment BERT model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing the output tensors from the conflict linear layers and the alignment linear layers.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.generate_prediction_file">
<span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.</span></span><span class="sig-name descname"><span class="pre">generate_prediction_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_lst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/test.html#generate_prediction_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.generate_prediction_file" title="Permalink to this definition"></a></dt>
<dd><p>Generate a prediction file from a list of predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred_lst</strong> (<em>list</em>) – List of predicted labels.</p></li>
<li><p><strong>output_file</strong> (<em>str</em>) – Path to the output file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.generate_prob_file">
<span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.</span></span><span class="sig-name descname"><span class="pre">generate_prob_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prob_lst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob_output_file_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/test.html#generate_prob_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.generate_prob_file" title="Permalink to this definition"></a></dt>
<dd><p>Generate a probability file from a list of probability lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prob_lst</strong> (<em>list</em>) – List of probability lists.</p></li>
<li><p><strong>prob_output_file_path</strong> (<em>str</em>) – Path to the output probability file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.inference">
<span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.</span></span><span class="sig-name descname"><span class="pre">inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mnli'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/test.html#inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.inference" title="Permalink to this definition"></a></dt>
<dd><p>Perform inference on the provided data using the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel" title="Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.MainModel"><em>MainModel</em></a>) – The trained model for inference.</p></li>
<li><p><strong>dataloader</strong> (<em>DataLoader</em>) – The DataLoader containing the data for inference.</p></li>
<li><p><strong>tokenizer</strong> – The tokenizer used for tokenizing the input data.</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device to perform inference on (e.g., ‘cpu’ or ‘cuda’).</p></li>
<li><p><strong>data</strong> (<em>str</em><em>, </em><em>optional</em>) – Specifies the type of data (‘mnli’ or ‘hans’). Defaults to ‘mnli’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the accuracy, predicted labels, and probabilities.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.main">
<span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/test.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.main" title="Permalink to this definition"></a></dt>
<dd><p>Main function to run evaluation on MNLI and HANS datasets.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.read_dataset">
<span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.</span></span><span class="sig-name descname"><span class="pre">read_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/test.html#read_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.test.read_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Reads a dataset object from a pickle file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_path</strong> (<em>str</em>) – Path to the pickle file containing the dataset.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dataset loaded from the pickle file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>data</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-Generate_Embeddings.NLI.Disentangled_feature_augmentation.train">
<span id="generate-embeddings-nli-disentangled-feature-augmentation-train-module"></span><h2>Generate_Embeddings.NLI.Disentangled_feature_augmentation.train module<a class="headerlink" href="#module-Generate_Embeddings.NLI.Disentangled_feature_augmentation.train" title="Permalink to this heading"></a></h2>
<p>This script trains a BERT-based model for Natural Language Inference(NLI) task using the Huggingface library.
It defines custom loss functions, data loaders, training, and validation functions, and supports model saving
and early stopping.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">train</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">dataset_name</span> <span class="o">&lt;</span><span class="n">DATASET_NAME</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">output_model_directory</span> <span class="o">&lt;</span><span class="n">OUTPUT_MODEL_DIR</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">output_tokenizer_directory</span> <span class="o">&lt;</span><span class="n">OUTPUT_TOKENIZER_DIR</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">dataset_name</span><span class="p">:</span> <span class="n">Name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">dataset</span> <span class="n">directory</span> <span class="n">containing</span> <span class="n">the</span> <span class="s1">&#39;questions.csv&#39;</span> <span class="n">file</span> <span class="k">for</span> <span class="n">training</span><span class="o">.</span>
<span class="o">--</span><span class="n">output_model_directory</span><span class="p">:</span> <span class="n">Directory</span> <span class="n">where</span> <span class="n">the</span> <span class="n">trained</span> <span class="n">model</span> <span class="n">will</span> <span class="n">be</span> <span class="n">saved</span><span class="o">.</span>
<span class="o">--</span><span class="n">output_tokenizer_directory</span><span class="p">:</span> <span class="n">Directory</span> <span class="n">where</span> <span class="n">the</span> <span class="n">tokenizer</span> <span class="n">will</span> <span class="n">be</span> <span class="n">saved</span><span class="o">.</span>
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.GeneralizedCELoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.</span></span><span class="sig-name descname"><span class="pre">GeneralizedCELoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/train.html#GeneralizedCELoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.GeneralizedCELoss" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Generalized Cross Entropy Loss function.</p>
<p>This loss function is an extension of Cross Entropy Loss (CE) with a
parameter <cite>q</cite> which allows to control the focus of the loss function
towards hard or easy examples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>q</strong> (<em>float</em>) – A parameter controlling the focus of the loss function.
The default value is 0.7.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.GeneralizedCELoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/train.html#GeneralizedCELoss.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.GeneralizedCELoss.forward" title="Permalink to this definition"></a></dt>
<dd><p>Computes the Generalized Cross Entropy loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logits</strong> (<em>torch.Tensor</em>) – Raw predictions from the model.</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Ground truth labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The computed loss.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NameError</strong> – If the computed probability or Yg (gathered probabilities)
    contains NaN values.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This implementation assumes a single-label classification task.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.GeneralizedCELoss.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.GeneralizedCELoss.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.MainModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.</span></span><span class="sig-name descname"><span class="pre">MainModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/train.html#MainModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.MainModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BertPreTrainedModel</span></code></p>
<p>Main model architecture for dual-BERT model.</p>
<p>This model architecture consists of two BERT models, each followed by
linear layers for conflict and alignment tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>BertConfig</em>) – Configuration for the BERT model.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.MainModel.features">
<span class="sig-name descname"><span class="pre">features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/train.html#MainModel.features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.MainModel.features" title="Permalink to this definition"></a></dt>
<dd><p>Extracts features from the BERT models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_ids</strong> (<em>torch.Tensor</em>) – Input token IDs.</p></li>
<li><p><strong>attention_mask</strong> (<em>torch.Tensor</em>) – Attention mask for input.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Features for conflict task.
torch.Tensor: Features for alignment task.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.MainModel.linear">
<span class="sig-name descname"><span class="pre">linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_conflict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_align</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/train.html#MainModel.linear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.MainModel.linear" title="Permalink to this definition"></a></dt>
<dd><p>Performs linear transformations on the features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_conflict</strong> (<em>torch.Tensor</em>) – Features for conflict task.</p></li>
<li><p><strong>z_align</strong> (<em>torch.Tensor</em>) – Features for alignment task.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output for conflict task.
torch.Tensor: Output for alignment task.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.MainModel.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.MainModel.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.main">
<span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/train.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.main" title="Permalink to this definition"></a></dt>
<dd><p>Main function to train the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.train">
<span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.</span></span><span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_loss_ema_d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_loss_ema_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/train.html#train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.train" title="Permalink to this definition"></a></dt>
<dd><p>Trains the provided model on the given data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.MainModel" title="Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.MainModel"><em>MainModel</em></a>) – The model to train.</p></li>
<li><p><strong>dataloader</strong> (<em>DataLoader</em>) – DataLoader containing the training data.</p></li>
<li><p><strong>optimizer</strong> (<em>torch.optim.Optimizer</em>) – Optimizer for updating model parameters.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – Device to perform computation on.</p></li>
<li><p><strong>swap</strong> (<em>bool</em>) – Flag indicating whether to perform swapping.</p></li>
<li><p><strong>scheduler</strong> (<em>torch.optim.lr_scheduler._LRScheduler</em>) – Learning rate scheduler.</p></li>
<li><p><strong>sample_loss_ema_d</strong> (<a class="reference internal" href="Generate_Embeddings.Entity_classification.Disentangled_feature_augmentation.html#Generate_Embeddings.Entity_classification.Disentangled_feature_augmentation.util.EMA" title="Generate_Embeddings.Entity_classification.Disentangled_feature_augmentation.util.EMA"><em>EMA</em></a>) – Exponential moving average for loss in conflict task.</p></li>
<li><p><strong>sample_loss_ema_b</strong> (<a class="reference internal" href="Generate_Embeddings.Entity_classification.Disentangled_feature_augmentation.html#Generate_Embeddings.Entity_classification.Disentangled_feature_augmentation.util.EMA" title="Generate_Embeddings.Entity_classification.Disentangled_feature_augmentation.util.EMA"><em>EMA</em></a>) – Exponential moving average for loss in alignment task.</p></li>
<li><p><strong>dataset_name</strong> (<em>str</em>) – Name of the dataset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.valid">
<span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.</span></span><span class="sig-name descname"><span class="pre">valid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/train.html#valid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.valid" title="Permalink to this definition"></a></dt>
<dd><p>Performs validation on the provided data loader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.MainModel" title="Generate_Embeddings.NLI.Disentangled_feature_augmentation.train.MainModel"><em>MainModel</em></a>) – The model to evaluate.</p></li>
<li><p><strong>dataloader</strong> (<em>DataLoader</em>) – DataLoader containing the validation data.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – Device to perform computation on.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing validation loss and accuracy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-Generate_Embeddings.NLI.Disentangled_feature_augmentation.util">
<span id="generate-embeddings-nli-disentangled-feature-augmentation-util-module"></span><h2>Generate_Embeddings.NLI.Disentangled_feature_augmentation.util module<a class="headerlink" href="#module-Generate_Embeddings.NLI.Disentangled_feature_augmentation.util" title="Permalink to this heading"></a></h2>
<p>This class implements Exponential Moving Average (EMA) for updating parameters.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ema</span> <span class="o">=</span> <span class="n">EMA</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">ema</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">curve</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">iter_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">ema</span><span class="o">.</span><span class="n">max_loss</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
</pre></div>
</div>
<p>Arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">label</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span> <span class="n">The</span> <span class="n">label</span> <span class="n">tensor</span><span class="o">.</span>
<span class="n">num_classes</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">optional</span><span class="p">):</span> <span class="n">Number</span> <span class="n">of</span> <span class="n">classes</span><span class="o">.</span> <span class="n">Defaults</span> <span class="n">to</span> <span class="kc">None</span><span class="o">.</span>
<span class="n">alpha</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">optional</span><span class="p">):</span> <span class="n">The</span> <span class="n">smoothing</span> <span class="n">factor</span><span class="o">.</span> <span class="n">Defaults</span> <span class="n">to</span> <span class="mf">0.9</span><span class="o">.</span>
<span class="n">data</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span> <span class="n">The</span> <span class="n">data</span> <span class="n">tensor</span><span class="o">.</span>
<span class="n">index</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span> <span class="n">The</span> <span class="n">index</span> <span class="n">tensor</span><span class="o">.</span>
<span class="n">curve</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">optional</span><span class="p">):</span> <span class="n">The</span> <span class="n">curve</span> <span class="n">tensor</span><span class="o">.</span> <span class="n">Defaults</span> <span class="n">to</span> <span class="kc">None</span><span class="o">.</span>
<span class="n">iter_range</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">optional</span><span class="p">):</span> <span class="n">The</span> <span class="nb">range</span> <span class="n">of</span> <span class="n">iterations</span><span class="o">.</span> <span class="n">Defaults</span> <span class="n">to</span> <span class="kc">None</span><span class="o">.</span>
<span class="n">step</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">optional</span><span class="p">):</span> <span class="n">The</span> <span class="n">step</span> <span class="n">size</span><span class="o">.</span> <span class="n">Defaults</span> <span class="n">to</span> <span class="kc">None</span><span class="o">.</span>
<span class="n">Modified</span> <span class="kn">from</span> <span class="nn">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">alinlab</span><span class="o">/</span><span class="n">LfF</span><span class="o">/</span><span class="n">blob</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">util</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.util.EMA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Generate_Embeddings.NLI.Disentangled_feature_augmentation.util.</span></span><span class="sig-name descname"><span class="pre">EMA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/util.html#EMA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.util.EMA" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.util.EMA.max_loss">
<span class="sig-name descname"><span class="pre">max_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/util.html#EMA.max_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.util.EMA.max_loss" title="Permalink to this definition"></a></dt>
<dd><p>Get the maximum loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>label</strong> – The label.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The maximum loss.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Generate_Embeddings.NLI.Disentangled_feature_augmentation.util.EMA.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">curve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Generate_Embeddings/NLI/Disentangled_feature_augmentation/util.html#EMA.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Generate_Embeddings.NLI.Disentangled_feature_augmentation.util.EMA.update" title="Permalink to this definition"></a></dt>
<dd><p>Update the parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – The data tensor.</p></li>
<li><p><strong>index</strong> (<em>torch.Tensor</em>) – The index tensor.</p></li>
<li><p><strong>curve</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – The curve tensor. Defaults to None.</p></li>
<li><p><strong>iter_range</strong> (<em>int</em><em>, </em><em>optional</em>) – The range of iterations. Defaults to None.</p></li>
<li><p><strong>step</strong> (<em>int</em><em>, </em><em>optional</em>) – The step size. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-Generate_Embeddings.NLI.Disentangled_feature_augmentation">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-Generate_Embeddings.NLI.Disentangled_feature_augmentation" title="Permalink to this heading"></a></h2>
<p>This module generates embeddings for NLI task using DisEnt model</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Generate_Embeddings.NLI.html" class="btn btn-neutral float-left" title="Generate_Embeddings.NLI package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Generate_Embeddings.NLI.Feature_sieve.html" class="btn btn-neutral float-right" title="Generate_Embeddings.NLI.Feature_sieve package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Aviral Singh and Sandeep Chatterjee.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>